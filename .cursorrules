# Cursor Rules cho dá»± Ã¡n TicketLMS

## ğŸ¯ Tá»•ng quan dá»± Ã¡n

-   **Framework**: Next.js 15 vá»›i App Router
-   **Language**: TypeScript
-   **Styling**: Tailwind CSS
-   **Database**: Supabase (PostgreSQL)
-   **Authentication**: Supabase Auth
-   **State Management**: React Query (TanStack Query)
-   **UI Components**: Radix UI + shadcn/ui

## ğŸ“ Cáº¥u trÃºc thÆ° má»¥c

```
src/
â”œâ”€â”€ app/                    # Next.js App Router pages
â”‚   â”œâ”€â”€ api/               # API routes
â”‚   â”œâ”€â”€ (auth)/            # Auth pages (login, register)
â”‚   â”œâ”€â”€ dashboard/         # Dashboard pages
â”‚   â”œâ”€â”€ tickets/           # Ticket management
â”‚   â”œâ”€â”€ users/             # User management
â”‚   â””â”€â”€ organizations/     # Organization management
â”œâ”€â”€ components/            # Reusable components
â”‚   â”œâ”€â”€ ui/               # Base UI components (shadcn/ui)
â”‚   â”œâ”€â”€ badges/           # Badge components (status, type, priority, etc.)
â”‚   â”œâ”€â”€ modals/           # Modal components (ImageModal, LinkModal, etc.)
â”‚   â”œâ”€â”€ forms/            # Form components (LoginForm, etc.)
â”‚   â”œâ”€â”€ common/           # Common utility components (HtmlContent, RichTextEditor)
â”‚   â”œâ”€â”€ navigation/       # Navigation components (DashboardNav, NotificationDropdown)
â”‚   â”œâ”€â”€ tickets/          # Ticket-specific components
â”‚   â”œâ”€â”€ dashboard/        # Dashboard components
â”‚   â”œâ”€â”€ providers/        # Context providers (QueryProvider)
â”‚   â””â”€â”€ index.ts          # Main barrel export
â”œâ”€â”€ hooks/                # Custom React hooks
â”œâ”€â”€ lib/                  # Utility functions & configurations
â”œâ”€â”€ types/                # TypeScript type definitions
â””â”€â”€ middleware.ts         # Next.js middleware
```

## ğŸ› ï¸ NguyÃªn táº¯c thiáº¿t káº¿

### 1. Component Organization

```
src/components/
â”œâ”€â”€ ui/                    # Base UI components (shadcn/ui)
â”œâ”€â”€ badges/               # Badge components (status, type, priority, etc.)
â”œâ”€â”€ modals/               # Modal components (ImageModal, LinkModal, etc.)
â”œâ”€â”€ forms/                # Form components (LoginForm, etc.)
â”œâ”€â”€ common/               # Common utility components (HtmlContent, RichTextEditor)
â”œâ”€â”€ navigation/           # Navigation components (DashboardNav, NotificationDropdown)
â”œâ”€â”€ tickets/              # Ticket-specific components
â”œâ”€â”€ dashboard/            # Dashboard components
â”œâ”€â”€ providers/            # Context providers (QueryProvider)
â””â”€â”€ index.ts              # Main barrel export
```

**NguyÃªn táº¯c tá»• chá»©c:**

-   **Domain-based**: NhÃ³m theo chá»©c nÄƒng nghiá»‡p vá»¥ (tickets, dashboard, etc.)
-   **Function-based**: NhÃ³m theo loáº¡i component (badges, modals, forms, etc.)
-   **Barrel Exports**: Má»—i nhÃ³m cÃ³ index.ts Ä‘á»ƒ export táº¥t cáº£ components
-   **Main Export**: src/components/index.ts export táº¥t cáº£ nhÃ³m

### 2. Component Architecture

-   **Atomic Design**: atoms â†’ molecules â†’ organisms â†’ templates â†’ pages
-   **Single Responsibility**: Má»—i component chá»‰ lÃ m má»™t viá»‡c
-   **Composition over Inheritance**: Æ¯u tiÃªn composition
-   **Props Interface**: LuÃ´n Ä‘á»‹nh nghÄ©a interface cho props
-   **Default Props**: Sá»­ dá»¥ng default values khi cáº§n thiáº¿t
-   **Organized Structure**: Components Ä‘Æ°á»£c nhÃ³m theo chá»©c nÄƒng vÃ  domain
-   **Barrel Exports**: Sá»­ dá»¥ng barrel exports cho organized imports

### 2. State Management

-   **Local State**: useState cho component-level state
-   **Server State**: React Query cho API data
-   **Global State**: TrÃ¡nh, chá»‰ dÃ¹ng khi thá»±c sá»± cáº§n thiáº¿t
-   **Form State**: react-hook-form vá»›i zod validation

### 3. API Design

-   **RESTful**: TuÃ¢n thá»§ REST principles
-   **Consistent Response**: LuÃ´n dÃ¹ng format response nháº¥t quÃ¡n
-   **Error Handling**: Proper error responses vá»›i status codes
-   **Authentication**: withAuth middleware cho protected routes
-   **Validation**: Zod schemas cho input validation

### 4. TypeScript Standards

-   **Strict Mode**: LuÃ´n báº­t strict mode
-   **Interface over Type**: Æ¯u tiÃªn interface cho object shapes
-   **Generic Types**: Sá»­ dá»¥ng generics cho reusable types
-   **Type Guards**: Sá»­ dá»¥ng type guards khi cáº§n
-   **No Any**: TrÃ¡nh sá»­ dá»¥ng `any`, dÃ¹ng `unknown` náº¿u cáº§n

## ğŸ“ Coding Standards

### 1. Naming Conventions

```typescript
// Components: PascalCase
export function TicketTable() {}

// Functions: camelCase
const fetchTickets = async () => {};

// Constants: UPPER_SNAKE_CASE
const API_BASE_URL = "https://api.example.com";

// Interfaces: PascalCase vá»›i I prefix cho complex interfaces
interface ITicketFormData {
    title: string;
    description: string;
}

// Types: PascalCase
type TicketStatus = "open" | "in_progress" | "closed";
```

### 2. File Naming

-   **Components**: PascalCase.tsx (TicketTable.tsx)
-   **Hooks**: camelCase.ts (useTicketList.ts)
-   **Utilities**: camelCase.ts (api-utils.ts)
-   **Types**: camelCase.ts (ticket.ts)
-   **Constants**: camelCase.ts (constants.ts)
-   **Barrel Exports**: index.ts (cho má»—i component group)

### 3. Import/Export

```typescript
// Prefer named exports
export function Component() {}
export const utility = () => {};

// Use barrel exports for organized imports
// components/badges/index.ts
export { TicketTypeBadge, TicketStatusBadge, TicketPriorityBadge } from "./";

// components/index.ts (main barrel export)
export * from "./ui";
export * from "./badges";
export * from "./modals";
export * from "./forms";
export * from "./common";
export * from "./navigation";
export * from "./tickets";
export * from "./dashboard";
export * from "./providers";

// Import order (prefer barrel imports)
import React from "react";
import { NextRequest } from "next/server";
import { Button } from "@/components/ui/button";
import { TicketTypeBadge, TicketStatusBadge } from "@/components/badges";
import { useTicketList } from "@/hooks/useTicketList";
import { Ticket } from "@/types";
```

### 4. Error Handling

```typescript
// API Routes
try {
    const result = await someOperation();
    return createSuccessResponse(result);
} catch (error) {
    return handleApiError(error, "context");
}

// Components
const { data, error, isLoading } = useQuery({
    queryKey: ["tickets"],
    queryFn: fetchTickets,
});

if (isLoading) return <LoadingSpinner />;
if (error) return <ErrorMessage error={error} />;
```

### 5. Form Handling

```typescript
// Use react-hook-form with zod
const form = useForm<FormData>({
    resolver: zodResolver(schema),
    defaultValues: {
        title: "",
        description: "",
    },
});

// Validation schema
const schema = z.object({
    title: z.string().min(1, "Title is required"),
    description: z
        .string()
        .min(10, "Description must be at least 10 characters"),
});
```

## ğŸ”’ Security Principles

### 1. Authentication & Authorization

-   **Server-side validation**: LuÃ´n validate trÃªn server
-   **Role-based access**: Kiá»ƒm tra role trÆ°á»›c khi cho phÃ©p action
-   **Organization isolation**: Non-admin users chá»‰ tháº¥y data cá»§a org mÃ¬nh
-   **Input sanitization**: Sanitize táº¥t cáº£ user inputs

### 2. Data Protection

-   **Environment variables**: Sá»­ dá»¥ng .env cho sensitive data
-   **No client secrets**: KhÃ´ng expose secrets ra client
-   **HTTPS only**: LuÃ´n sá»­ dá»¥ng HTTPS
-   **CORS**: Configure CORS properly

## ğŸ¨ UI/UX Standards

### 1. Design System

-   **Consistent spacing**: Sá»­ dá»¥ng Tailwind spacing scale
-   **Color palette**: Sá»­ dá»¥ng Tailwind colors
-   **Typography**: Consistent font sizes vÃ  weights
-   **Responsive design**: Mobile-first approach

### 2. Accessibility

-   **Semantic HTML**: Sá»­ dá»¥ng semantic elements
-   **ARIA labels**: ThÃªm ARIA labels khi cáº§n
-   **Keyboard navigation**: Há»— trá»£ keyboard navigation
-   **Color contrast**: Äáº£m báº£o contrast ratio Ä‘á»§

### 3. Loading States

```typescript
// Always show loading states
if (isLoading) {
    return <LoadingSpinner />;
}

// Skeleton loading cho better UX
if (isLoading) {
    return <TicketTableSkeleton />;
}
```

## ğŸš€ Performance Standards

### 1. Code Splitting

-   **Dynamic imports**: Sá»­ dá»¥ng dynamic imports cho large components
-   **Route-based splitting**: Next.js tá»± Ä‘á»™ng code splitting
-   **Component lazy loading**: Lazy load components khi cáº§n

### 2. Caching Strategy

-   **React Query**: Sá»­ dá»¥ng React Query cho server state caching
-   **Static generation**: Sá»­ dá»¥ng SSG khi cÃ³ thá»ƒ
-   **CDN**: Sá»­ dá»¥ng CDN cho static assets

### 3. Bundle Optimization

-   **Tree shaking**: Äáº£m báº£o tree shaking hoáº¡t Ä‘á»™ng
-   **Bundle analysis**: Sá»­ dá»¥ng bundle analyzer
-   **Dependency optimization**: Loáº¡i bá» unused dependencies

## ğŸ§ª Testing Standards

### 1. Test Structure

```typescript
// Component tests
describe("TicketTable", () => {
    it("should render tickets correctly", () => {
        // test implementation
    });
});

// API tests
describe("POST /api/tickets", () => {
    it("should create ticket successfully", () => {
        // test implementation
    });
});
```

### 2. Test Coverage

-   **Unit tests**: Cho utilities vÃ  hooks
-   **Integration tests**: Cho API routes
-   **E2E tests**: Cho critical user flows

## ğŸ“š Documentation Standards

### 1. Code Comments

```typescript
/**
 * Fetches tickets with pagination and filtering
 * @param page - Current page number
 * @param filters - Filter options
 * @returns Promise with tickets data
 */
export async function fetchTickets(page: number, filters: TicketFilters) {
    // implementation
}
```

### 2. README Structure

-   **Project overview**
-   **Setup instructions**
-   **API documentation**
-   **Component documentation**
-   **Deployment guide**

## ğŸ”„ Git Workflow

### 1. Commit Messages

```
feat: add ticket creation functionality
fix: resolve infinite render issue
refactor: improve API error handling
docs: update README with new features
test: add unit tests for ticket hooks
```

### 2. Branch Naming

-   `feature/ticket-management`
-   `fix/auth-bug`
-   `refactor/api-structure`
-   `docs/update-readme`

## ğŸš¨ Anti-patterns to Avoid

### 1. Code Anti-patterns

-   âŒ Using `any` type
-   âŒ Mutating props directly
-   âŒ Large monolithic components
-   âŒ Inline styles
-   âŒ Console.log in production
-   âŒ Hardcoded values
-   âŒ Scattered component organization
-   âŒ Inconsistent import patterns

### 2. Performance Anti-patterns

-   âŒ Unnecessary re-renders
-   âŒ Large bundle sizes
-   âŒ Blocking operations in render
-   âŒ Memory leaks

### 3. Security Anti-patterns

-   âŒ Client-side validation only
-   âŒ Exposing sensitive data
-   âŒ No input sanitization
-   âŒ Weak authentication

## âš ï¸ Quy Ä‘á»‹nh nghiÃªm ngáº·t

### 1. KhÃ´ng tá»± táº¡o file bÃ¡o cÃ¡o

-   âŒ **KHÃ”NG** tá»± táº¡o file `.md` Ä‘á»ƒ bÃ¡o cÃ¡o
-   âŒ **KHÃ”NG** táº¡o file `CLEANUP_REPORT.md`, `OPTIMIZATION_REPORT.md`, etc.
-   âŒ **KHÃ”NG** táº¡o file documentation khÃ´ng Ä‘Æ°á»£c yÃªu cáº§u
-   âœ… Chá»‰ táº¡o file `.md` khi Ä‘Æ°á»£c yÃªu cáº§u cá»¥ thá»ƒ

### 2. KhÃ´ng tá»± Ã½ refactor code

-   âŒ **KHÃ”NG** tá»± Ã½ refactor code mÃ  khÃ´ng Ä‘Æ°á»£c yÃªu cáº§u
-   âŒ **KHÃ”NG** thay Ä‘á»•i cáº¥u trÃºc API mÃ  khÃ´ng cÃ³ lÃ½ do cá»¥ thá»ƒ
-   âŒ **KHÃ”NG** refactor components mÃ  khÃ´ng Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh
-   âœ… Chá»‰ refactor khi Ä‘Æ°á»£c yÃªu cáº§u rÃµ rÃ ng

### 3. XÃ¡c nháº­n trÆ°á»›c khi refactor

-   âœ… **LUÃ”N** xÃ¡c nháº­n vá»›i user trÆ°á»›c khi refactor code
-   âœ… **GIáº¢I THÃCH** lÃ½ do cáº§n refactor vÃ  lá»£i Ã­ch
-   âœ… **Äá»€ XUáº¤T** phÆ°Æ¡ng Ã¡n refactor cá»¥ thá»ƒ
-   âœ… **CHá»œ** sá»± Ä‘á»“ng Ã½ trÆ°á»›c khi thá»±c hiá»‡n
-   âœ… **CHá»ˆ** refactor khi user Ä‘á»“ng Ã½

### 4. NguyÃªn táº¯c lÃ m viá»‡c

-   ğŸ” **Táº¬P TRUNG** vÃ o task Ä‘Æ°á»£c yÃªu cáº§u
-   ğŸ¯ **CHÃNH XÃC** - chá»‰ lÃ m nhá»¯ng gÃ¬ Ä‘Æ°á»£c yÃªu cáº§u
-   ğŸ“ **RÃ• RÃ€NG** - giáº£i thÃ­ch rÃµ má»i thay Ä‘á»•i
-   âš¡ **HIá»†U QUáº¢** - hoÃ n thÃ nh task nhanh chÃ³ng
-   ğŸ›¡ï¸ **AN TOÃ€N** - khÃ´ng lÃ m há»ng code hiá»‡n táº¡i

## ğŸ¯ Best Practices Summary

1. **Write clean, readable code**
2. **Follow TypeScript best practices**
3. **Implement proper error handling**
4. **Use consistent naming conventions**
5. **Write comprehensive tests**
6. **Document your code**
7. **Optimize for performance**
8. **Prioritize security**
9. **Maintain accessibility**
10. **Follow the established patterns**
11. **Organize components by domain and functionality**
12. **Use barrel exports for clean imports**

## ğŸ”§ Development Tools

### 1. Essential Extensions

-   TypeScript
-   ESLint
-   Prettier
-   Tailwind CSS IntelliSense
-   GitLens

### 2. Scripts

```json
{
    "scripts": {
        "dev": "next dev",
        "build": "next build",
        "start": "next start",
        "lint": "next lint",
        "type-check": "tsc --noEmit"
    }
}
```

---

**LÆ°u Ã½**: TuÃ¢n thá»§ cÃ¡c nguyÃªn táº¯c nÃ y sáº½ giÃºp code dá»… Ä‘á»c, báº£o trÃ¬ vÃ  nÃ¢ng cáº¥p. LuÃ´n Æ°u tiÃªn code quality vÃ  user experience.
